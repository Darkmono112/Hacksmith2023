{% extends "DroneConesApp/misc/base.html" %}

{% block title %}Order{% endblock %}

{% load static %}
{% block content %}

{% comment "" %}  
Plan : Finished by this week 
    Composition:   
        Base html will handle the navbar and 
        Have selctions 
        Have floating boxes for each piece 
            For icecream selection have Image of icecream with a title under it 
                and for toppings and cones  
        Bottom floating action button? or sticky bar at bottom of the page 
            Like the Micky D app 
        Have a floating box that creates your current cone 
        List out the cones in another box 
        Current price next to the order button
        Add another cone to order button somewhere 
        

{% endcomment %}

{% comment "" %} This is the icecream div

For each flavor in the table 
Take the name for the flavor, 
find the png, and add it to the flavor 
make a dot out of it and add it to the div

Change it from Horizontal scrolling to Vertical every 5 entries 


{% endcomment %}
<link rel="stylesheet" href="{% static 'DroneConesApp/css/orderpage.css' %}">
<div class="content-container">
    <h1 style="text-align: center; font-size: 50px">Ice Cream</h1>
    <hr style="margin-top: -20px; margin-bottom: 30px">
    <div class="sub-content-container">
        <div class="option-list">
            <ul style="list-style: none; padding: 0; margin: 10px;">
                <li><a><img src="{% static 'DroneConesApp/images/Sprites/IceCream/all.png' %}" width="70px" height="70px"><span class="list-label">Ice Cream</span></a></li>
                <li><a><img src="{% static 'DroneConesApp/images/Sprites/Cones/all.png' %}" width="70px" height="70px"><span class="list-label">Cones</span></a></li>
                <li><a><img src="{% static 'DroneConesApp/images/Sprites/Toppings/all.png' %}" width="70px" height="70px"><span class="list-label">Toppings</span></a></li>
            </ul>
        </div>

        <div id="icecreamflavors" style="display: block; margin-left: 50px">
            {% for flavor in ice_cream_flavors %}
            <div id="{{flavor.flavor}}" style="display: inline-block"><a class="pick-icon" href="#"><img style="width: 100px; height: auto;" src="{% static 'DroneConesApp/images/Sprites/IceCream/'|add:flavor.flavor|add:'.png' %}"><li>{{flavor.flavor}}</li></a></div>
            {% endfor %}
        </div>

        <div id="coneflavors" style="display: none; margin-left: 50px">
            {% for flavor in cone_flavors %}
            <div style="display: inline-block"><a class="pick-icon" href="#"><img style="width: 100px; height: auto;" src="{% static 'DroneConesApp/images/Sprites/Cones/'|add:flavor.flavor|add:'.png' %}"><li>{{flavor.flavor}}</li></a></div>
            {% endfor %}
        </div>

        <div id="toppingflavors" style="display: none; margin-left: 50px">
            {% for flavor in topping_flavors %}
            <div style="display: inline-block"><a class="pick-icon" href="#"><img style="width: 100px; height: auto;" src="{% static 'DroneConesApp/images/Sprites/Toppings/'|add:flavor.flavor|add:'.png' %}"><li>{{flavor.flavor}}</li></a></div>
            {% endfor %}
        </div>

    </div>
</div>
<div class="content-container" style="margin-left: 50px; width: 40%" >
    <h1 style="text-align: center; font-size: 50px">My Order</h1>
    <hr style="margin-top: -20px; margin-bottom: 30px">
    <div class="sub-content-container" id="myOrderContainer">
        <div>
            <span>Order Amount:</span>
            <span>${{}}</span>
        </div>
    </div>
</div>

<script>
// JavaScript code to handle option selection and flavor selection

// Option list
const optionList = document.querySelector('.option-list ul');
const optionItems = optionList.querySelectorAll('li');
const iceCreamFlavors = document.getElementById('icecreamflavors');
const coneFlavors = document.getElementById('coneflavors');
const toppingFlavors = document.getElementById('toppingflavors');

optionItems.forEach((item) => {
    item.addEventListener('click', (event) => {
        optionItems.forEach((el) => {
            el.classList.remove('selected');
        });
        item.classList.add('selected');
        const selectedOption = item.querySelector('a > span').textContent.toLowerCase();
        iceCreamFlavors.style.display = 'none';
        coneFlavors.style.display = 'none';
        toppingFlavors.style.display = 'none';

        if (selectedOption === 'ice cream') {
            iceCreamFlavors.style.display = 'block';
        } else if (selectedOption === 'cones') {
            coneFlavors.style.display = 'block';
        } else if (selectedOption === 'toppings') {
            toppingFlavors.style.display = 'block';
        }
    });
});
</script>

<script>
const flavorDivs = document.querySelectorAll('.pick-icon');
const myOrderContainer = document.getElementById('myOrderContainer');
let totalPrice = 0;

flavorDivs.forEach((flavorDiv) => {
    const flavorImage = flavorDiv.querySelector('img');
    const flavorName = flavorDiv.querySelector('li').textContent;
    const flavorPrice = Number(flavorDiv.getAttribute('data-price'));
    let isButtonVisible = false;

    // Create the "Add to Order" button
    const addButton = document.createElement('button');
    addButton.textContent = 'Add to Order';
    addButton.style.display = 'none';

    flavorDiv.appendChild(addButton);

    flavorDiv.addEventListener('click', () => {
        if (!isButtonVisible) {
            addButton.style.display = 'block';
            isButtonVisible = true;
        } else {
            addButton.style.display = 'none';
            isButtonVisible = false;
        }
    });

    addButton.addEventListener('click', () => {
        // Create a new entry in the order
        const orderEntry = document.createElement('div');
        orderEntry.classList.add('order-entry');
        const orderImage = flavorImage.cloneNode(true);
        const orderName = document.createElement('span');
        orderName.textContent = flavorName;
        orderEntry.appendChild(orderImage);
        orderEntry.appendChild(orderName);
        myOrderContainer.appendChild(orderEntry);

        // Update the total price
        totalPrice += flavorPrice;
        document.getElementById('total-price').textContent = totalPrice.toFixed(2); // Display as currency
    });
});
</script>


{% endblock %}