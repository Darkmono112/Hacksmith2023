{% extends "DroneConesApp/misc/base.html" %}

{% block title %}Checkout{% endblock %}

{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'DroneConesApp/css/order_tracking.css' %}">
<script src="" defer></script>

<div id="order_tracking">
    <div style="text-align: center;">
        <h1>Thanks for your order!</h1>
        <p>We are working hard to get your order to you ASAP</p>
        <h4 id="countdown-timer"></h4>
    </div>
    <!-- Loop through items if we want to -->
    <div>
        <iframe width="100%" height="600" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" 
            src="https://maps.google.com/maps?width=100%25&amp;height=600&amp;hl=en&amp;q={{ address|urlencode }}&amp;t=&amp;z=14&amp;ie=UTF8&amp;iwloc=B&amp;output=embed">
        </iframe>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const targetTime = new Date("{{ order_date }}").getTime() + 5 * 60 * 1000;

    function updateCountdown() {
        const now = new Date().getTime();
        const remainingTime = targetTime - now;

        if (remainingTime <= 0) {
            document.getElementById("countdown-timer").textContent = "Delivered!";
        } else {
            const minutes = Math.floor(remainingTime / (60 * 1000));
            const seconds = Math.floor((remainingTime / 1000) % 60);

            document.getElementById("countdown-timer").textContent = `Remaining time: ${minutes}:${(seconds < 10 ? '0' : '')}${seconds}`;
        }
    }

    updateCountdown();
    setInterval(updateCountdown, 1000);
});

</script>


{% endblock %}